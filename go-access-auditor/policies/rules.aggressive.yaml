# AGRESSIVA: inclui regras prudentes + operações potencialmente arriscadas
# Base crítica
- { name: "danger-rm-root",         regex: "(?i)\\brm\\s+-rf\\s+/(\\s|$)" }
- { name: "chmod-777",              regex: "(?i)\\bchmod\\s+(-R\\s+)?777\\b" }
- { name: "chown-root-recursive",   regex: "(?i)\\bchown\\s+-R\\s+root:root\\b" }
- { name: "passwd-root",            regex: "(?i)\\bpasswd\\s+root\\b" }
- { name: "sudoers-edit",           regex: "(?i)\\bvisudo\\b|/etc/sudoers" }

# Kubernetes/Helm
- { name: "kubectl-delete-all",     regex: "(?i)\\bkubectl\\s+delete\\s+\\S+\\s+--all(\\s|$)" }
- { name: "kubectl-drain-force",    regex: "(?i)\\bkubectl\\s+drain\\b.*\\b--force\\b" }
- { name: "kubectl-apply-prd",      regex: "(?i)\\bkubectl\\s+apply\\b.*\\b(-n|--namespace)\\s*(prod|production)\\b" }
- { name: "helm-upgrade-prd",       regex: "(?i)\\bhelm\\s+upgrade\\b.*\\b(-n|--namespace)\\s*(prod|production)\\b" }
- { name: "helm-uninstall-prd",     regex: "(?i)\\bhelm\\s+uninstall\\b.*\\b(-n|--namespace)\\s*(prod|production)\\b" }

# SQL
- { name: "drop-database",          regex: "(?i)\\bdrop\\s+database\\b" }
- { name: "drop-table",             regex: "(?i)\\bdrop\\s+table\\b" }
- { name: "truncate-table",         regex: "(?i)\\btruncate\\s+table\\b" }
- { name: "update-no-where",        regex: "(?i)\\bupdate\\s+\\S+\\s+set\\b(?!.*\\bwhere\\b)" }
- { name: "delete-no-where",        regex: "(?i)\\bdelete\\s+from\\s+\\S+\\b(?!.*\\bwhere\\b)" }

# Rede/Firewall
- { name: "iptables-flush",         regex: "(?i)\\biptables\\s+-F\\b" }
- { name: "ufw-disable",            regex: "(?i)\\bufw\\s+disable\\b" }

# Sistemas/variações
- { name: "mount-rw-root",          regex: "(?i)\\bmount\\b.*\\s/\\s.*\\brw\\b" }
- { name: "systemctl-stop-all",     regex: "(?i)\\bsystemctl\\s+stop\\s+\\*\\b" }

# Dica: mantenha a rules.extended.yaml como conjunto “default”, prudent para produção conservadora e aggressive para ambientes de sandbox/forense.